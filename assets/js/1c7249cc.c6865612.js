"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9465],{5162:(e,a,t)=>{t.d(a,{Z:()=>s});var n=t(7294),l=t(6010);const r="tabItem_Ymn6";function s(e){let{children:a,hidden:t,className:s}=e;return n.createElement("div",{role:"tabpanel",className:(0,l.Z)(r,s),hidden:t},a)}},4866:(e,a,t)=>{t.d(a,{Z:()=>S});var n=t(7462),l=t(7294),r=t(6010),s=t(2466),o=t(6550),i=t(1980),d=t(7392),u=t(12);function m(e){return function(e){var a;return(null==(a=l.Children.map(e,(e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:a}=e;return!!a&&"object"==typeof a&&"value"in a}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})))?void 0:a.filter(Boolean))??[]}(e).map((e=>{let{props:{value:a,label:t,attributes:n,default:l}}=e;return{value:a,label:t,attributes:n,default:l}}))}function p(e){const{values:a,children:t}=e;return(0,l.useMemo)((()=>{const e=a??m(t);return function(e){const a=(0,d.l)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,t])}function h(e){let{value:a,tabValues:t}=e;return t.some((e=>e.value===a))}function c(e){let{queryString:a=!1,groupId:t}=e;const n=(0,o.k6)(),r=function(e){let{queryString:a=!1,groupId:t}=e;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:a,groupId:t});return[(0,i._X)(r),(0,l.useCallback)((e=>{if(!r)return;const a=new URLSearchParams(n.location.search);a.set(r,e),n.replace({...n.location,search:a.toString()})}),[r,n])]}function v(e){const{defaultValue:a,queryString:t=!1,groupId:n}=e,r=p(e),[s,o]=(0,l.useState)((()=>function(e){let{defaultValue:a,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!h({value:a,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${a}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return a}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:a,tabValues:r}))),[i,d]=c({queryString:t,groupId:n}),[m,v]=function(e){let{groupId:a}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(a),[n,r]=(0,u.Nk)(t);return[n,(0,l.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:n}),g=(()=>{const e=i??m;return h({value:e,tabValues:r})?e:null})();(0,l.useLayoutEffect)((()=>{g&&o(g)}),[g]);return{selectedValue:s,selectValue:(0,l.useCallback)((e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),v(e)}),[d,v,r]),tabValues:r}}var g=t(2389);const k="tabList__CuJ",y="tabItem_LNqP";function f(e){let{className:a,block:t,selectedValue:o,selectValue:i,tabValues:d}=e;const u=[],{blockElementScrollPositionUntilNextRender:m}=(0,s.o5)(),p=e=>{const a=e.currentTarget,t=u.indexOf(a),n=d[t].value;n!==o&&(m(a),i(n))},h=e=>{var a;let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const a=u.indexOf(e.currentTarget)+1;t=u[a]??u[0];break}case"ArrowLeft":{const a=u.indexOf(e.currentTarget)-1;t=u[a]??u[u.length-1];break}}null==(a=t)||a.focus()};return l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},a)},d.map((e=>{let{value:a,label:t,attributes:s}=e;return l.createElement("li",(0,n.Z)({role:"tab",tabIndex:o===a?0:-1,"aria-selected":o===a,key:a,ref:e=>u.push(e),onKeyDown:h,onClick:p},s,{className:(0,r.Z)("tabs__item",y,null==s?void 0:s.className,{"tabs__item--active":o===a})}),t??a)})))}function b(e){let{lazy:a,children:t,selectedValue:n}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(a){const e=r.find((e=>e.props.value===n));return e?(0,l.cloneElement)(e,{className:"margin-top--md"}):null}return l.createElement("div",{className:"margin-top--md"},r.map(((e,a)=>(0,l.cloneElement)(e,{key:a,hidden:e.props.value!==n}))))}function N(e){const a=v(e);return l.createElement("div",{className:(0,r.Z)("tabs-container",k)},l.createElement(f,(0,n.Z)({},e,a)),l.createElement(b,(0,n.Z)({},e,a)))}function S(e){const a=(0,g.Z)();return l.createElement(N,(0,n.Z)({key:String(a)},e))}},7218:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>m,contentTitle:()=>d,default:()=>c,frontMatter:()=>i,metadata:()=>u,toc:()=>p});var n=t(7462),l=(t(7294),t(3905)),r=t(4866),s=t(5162),o=t(814);const i={title:"madhava Server Installation",description:"Madhava Intermediate Server Installation",keywords:["madhava","installation"]},d="Madhava Intermediate Server Installation",u={unversionedId:"installation/madhava_install",id:"installation/madhava_install",title:"madhava Server Installation",description:"Madhava Intermediate Server Installation",source:"@site/docs/installation/madhava_install.md",sourceDirName:"installation",slug:"/installation/madhava_install",permalink:"/docs/installation/madhava_install",draft:!1,editUrl:"https://github.com/gyeeta/gyeeta.github.io/tree/main/docs/installation/madhava_install.md",tags:[],version:"current",lastUpdatedAt:1669142033,formattedLastUpdatedAt:"Nov 22, 2022",frontMatter:{title:"madhava Server Installation",description:"Madhava Intermediate Server Installation",keywords:["madhava","installation"]},sidebar:"docs",previous:{title:"madhava Server Configuration",permalink:"/docs/installation/madhava_config"},next:{title:"Partha Agent Configuration",permalink:"/docs/installation/partha_config"}},m={},p=[{value:"Network Connectivity Requirements",id:"network",level:2},{value:"Installation Instructions",id:"installation-instructions",level:2},{value:"<em>Install using Shell script</em>",id:"shell-script",level:3},{value:"Stopping/Starting/Uninstalling the Madhava Server",id:"stoppingstartinguninstalling-the-madhava-server",level:4},{value:"<em>Install using Kubernetes Helm Chart</em>",id:"helm-chart",level:3},{value:"<em>Running as a Docker container</em>",id:"docker",level:3},{value:"<em>Install using native rpm or deb packages</em>",id:"rpm-deb",level:3},{value:"Madhava Configuration post Installation",id:"madhava-configuration-post-installation",level:4},{value:"Stopping/Starting/Uninstalling the Madhava Server",id:"stoppingstartinguninstalling-the-madhava-server-1",level:4},{value:"<em>Manual Tar Package install</em>",id:"tar-install",level:3},{value:"Madhava Failover / Redundancy",id:"madhava-failover--redundancy",level:2}],h={toc:p};function c(e){let{components:a,...t}=e;return(0,l.kt)("wrapper",(0,n.Z)({},h,t,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"madhava-intermediate-server-installation"},"Madhava Intermediate Server Installation"),(0,l.kt)("h2",{id:"network"},"Network Connectivity Requirements"),(0,l.kt)("p",null,"Madhava Intermediate servers connect to Shyama Central server and also communicate with Partha Host Agents\nand Node Webserver."),(0,l.kt)("p",null,"It is recommended that the Madhava server and its PostgresDB be in the same Network Region and Zone to limit\nNetwork costs and for better performance."),(0,l.kt)("p",null,"Firewall rules must allow inbound access to the Madhava server on the configured Madhava port (default port is 10038)."),(0,l.kt)("h2",{id:"installation-instructions"},"Installation Instructions"),(0,l.kt)("p",null,"Different Install Options exist :"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#shell-script"},"Install using Shell Script")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#helm-chart"},"Install using Kubernetes Helm Chart")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#docker"},"Running as a Docker container")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#rpm-deb"},"Install using native rpm or deb packages")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#tar-install"},"Manual Tar Package install"))),(0,l.kt)("p",null,"Except for Kubernetes installs, please ensure that the Postgres DB instance is installed and the Madhava Config\nfile in JSON format is ready as per ",(0,l.kt)("a",{parentName:"p",href:"./madhava_config"},"Madhava Config"),"."),(0,l.kt)("h3",{id:"shell-script"},(0,l.kt)("em",{parentName:"h3"},"Install using Shell script")),(0,l.kt)("p",null,"Users can download a shell script that takes care of the installation and configuration of the Madhava instance."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"Before installing Madhava, users need to create a JSON config file as per the ",(0,l.kt)("a",{parentName:"p",href:"./madhava_config"},"Madhava Config"),".")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\ncurl -o /tmp/install-gyeeta-madhava.sh -s https://gyeeta.io/packages/install-gyeeta-madhava.sh\n\n# Then run the install script as : \n# sudo bash /tmp/install-gyeeta-madhava.sh <Path to Madhava Config file in JSON format>\n\n# Example Install Command (Please configure the /tmp/madhava.json config file first) :\n\nsudo bash /tmp/install-gyeeta-madhava.sh /tmp/madhava.json\n\n")),(0,l.kt)("p",null,"The install script SHA256 can be checked before installing. The SHA256 of the install script is available at ",(0,l.kt)("a",{parentName:"p",href:"https://gyeeta.io/packages/install-gyeeta-madhava.sh.sum"},"SHA256 file")),(0,l.kt)("h4",{id:"stoppingstartinguninstalling-the-madhava-server"},"Stopping/Starting/Uninstalling the Madhava Server"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Command to stop the Madhava Server"',title:'"Command',to:!0,stop:!0,the:!0,Madhava:!0,'Server"':!0},"\nsudo systemctl stop gyeeta-madhava\n\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Command to start the Madhava Server"',title:'"Command',to:!0,start:!0,the:!0,Madhava:!0,'Server"':!0},"\nsudo systemctl start gyeeta-madhava\n\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Command to uninstall Madhava Server")),(0,l.kt)(r.Z,{mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"UbuntuDebian",label:"Ubuntu / Debian",default:!0,mdxType:"TabItem"},(0,l.kt)(o.Z,{language:"sh",mdxType:"CodeBlock"},"sudo systemctl disable gyeeta-madhava; sudo apt-get remove gyeeta-madhava")),(0,l.kt)(s.Z,{value:"rhel",label:"RHEL / Rocky Linux / Amazon Linux",mdxType:"TabItem"},(0,l.kt)(o.Z,{language:"sh",mdxType:"CodeBlock"},"sudo systemctl disable gyeeta-madhava; sudo yum erase gyeeta-madhava")),(0,l.kt)(s.Z,{value:"suse",label:"SuSE / OpenSuSE",mdxType:"TabItem"},(0,l.kt)(o.Z,{language:"sh",mdxType:"CodeBlock"},"sudo systemctl disable gyeeta-madhava; sudo zypper remove gyeeta-madhava")),(0,l.kt)(s.Z,{value:"fedora",label:"Fedora Linux",mdxType:"TabItem"},(0,l.kt)(o.Z,{language:"sh",mdxType:"CodeBlock"},"sudo systemctl disable gyeeta-madhava; sudo dnf remove gyeeta-madhava"))),(0,l.kt)("h3",{id:"helm-chart"},(0,l.kt)("em",{parentName:"h3"},"Install using Kubernetes Helm Chart")),(0,l.kt)("p",null,"Kubernetes 1.19 or higher is needed along with Helm v3."),(0,l.kt)("p",null,"Refer to ",(0,l.kt)("a",{parentName:"p",href:"./k8s_helm/madhava_helm"},"Madhava Helm Chart")," for a detailed explanation on installing Madhava servers in Kubernetes."),(0,l.kt)("p",null,"A short explanation is shown below :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nhelm repo add gyeeta https://gyeeta.io/helmcharts\nhelm repo update\nhelm show values gyeeta/madhava > /tmp/madhava.yaml\n\n# Thereafter you can edit the /tmp/madhava.yaml file if you need to change any option. \n# After editing the /tmp/madhava.yaml, install the Madhava Helm chart using :\n\nhelm install --namespace gyeeta --create-namespace madhava1  gyeeta/madhava -f /tmp/madhava.yaml\n\n")),(0,l.kt)("h3",{id:"docker"},(0,l.kt)("em",{parentName:"h3"},"Running as a Docker container")),(0,l.kt)("p",null,"A JSON config file needs to be created first as per ",(0,l.kt)("a",{parentName:"p",href:"./madhava_config"},"Madhava Config")),(0,l.kt)("p",null,"In the example command below, /tmp/madhava.json config file has already been created on the main host."),(0,l.kt)("p",null,"The docker container will only run under userid 1001 and groupid 1001."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\ndocker run --rm -td --name madhava --read-only --user 1001:1001 -p 10037:10037 --env CFG_MAIN_JSON=/tmp/madhava.json -v /tmp/madhava.json:/tmp/madhava.json:ro ghcr.io/gyeeta/madhava start\n\n")),(0,l.kt)("h3",{id:"rpm-deb"},(0,l.kt)("em",{parentName:"h3"},"Install using native rpm or deb packages")),(0,l.kt)("p",null,"Gyeeta native rpm or deb packages are available. The install is to be followed by Madhava configuration."),(0,l.kt)(r.Z,{mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"UbuntuDebian",label:"Ubuntu / Debian",default:!0,mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'curl https://pkg.gyeeta.workers.dev/pgp-key.public | sudo gpg --yes --dearmor --output /usr/share/keyrings/gyeeta-keyring.gpg\necho "deb [arch=amd64 signed-by=/usr/share/keyrings/gyeeta-keyring.gpg] https://pkg.gyeeta.workers.dev/apt-repo stable main" | sudo tee /etc/apt/sources.list.d/gyeeta.list\nsudo apt-get update\nsudo apt-get install -y gyeeta-madhava\n'))),(0,l.kt)(s.Z,{value:"rhel",label:"RHEL / Rocky Linux / Amazon Linux",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"sudo rpm --import https://pkg.gyeeta.workers.dev/pgp-key.public\nsudo curl -s -o /etc/yum.repos.d/gyeeta.repo https://pkg.gyeeta.workers.dev/rpm-repo/gyeeta.repo\nsudo yum -y update\nsudo yum install -y gyeeta-madhava\n"))),(0,l.kt)(s.Z,{value:"suse",label:"SuSE / OpenSuSE",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"sudo rpm --import https://pkg.gyeeta.workers.dev/pgp-key.public\nsudo curl -s -o /etc/zypp/repos.d/gyeeta.repo https://pkg.gyeeta.workers.dev/rpm-repo/gyeeta.repo\nsudo zypper -q -n install gyeeta-madhava\n"))),(0,l.kt)(s.Z,{value:"fedora",label:"Fedora Linux",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"sudo rpm --import https://pkg.gyeeta.workers.dev/pgp-key.public\nsudo curl -s -o /etc/yum.repos.d/gyeeta.repo https://pkg.gyeeta.workers.dev/rpm-repo/gyeeta.repo\nsudo dnf -y update\nsudo dnf install -y gyeeta-madhava\n")))),(0,l.kt)("h4",{id:"madhava-configuration-post-installation"},"Madhava Configuration post Installation"),(0,l.kt)("p",null,"After the deb or rpm package has been installed, the Madhava config file ",(0,l.kt)("inlineCode",{parentName:"p"},"/opt/gyeeta/madhava/cfg/madhava_main.json")," needs\nto be edited as per ",(0,l.kt)("a",{parentName:"p",href:"./madhava_config"},"Madhava Config"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Start Madhava after editing the madhava_main.json"',title:'"Start',Madhava:!0,after:!0,editing:!0,the:!0,'madhava_main.json"':!0},"\n# After editing the /opt/gyeeta/madhava/cfg/madhava_main.json config file\nsudo systemctl start gyeeta-madhava\nsudo systemctl enable gyeeta-madhava\n\n")),(0,l.kt)("h4",{id:"stoppingstartinguninstalling-the-madhava-server-1"},"Stopping/Starting/Uninstalling the Madhava Server"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Command to stop the Madhava Server"',title:'"Command',to:!0,stop:!0,the:!0,Madhava:!0,'Server"':!0},"\nsudo systemctl stop gyeeta-madhava\n\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Command to start the Madhava Server"',title:'"Command',to:!0,start:!0,the:!0,Madhava:!0,'Server"':!0},"\nsudo systemctl start gyeeta-madhava\n\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Command to uninstall Madhava Server")),(0,l.kt)(r.Z,{mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"UbuntuDebian",label:"Ubuntu / Debian",default:!0,mdxType:"TabItem"},(0,l.kt)(o.Z,{language:"sh",mdxType:"CodeBlock"},"sudo systemctl disable gyeeta-madhava; sudo apt-get remove gyeeta-madhava")),(0,l.kt)(s.Z,{value:"rhel",label:"RHEL / Rocky Linux / Amazon Linux",mdxType:"TabItem"},(0,l.kt)(o.Z,{language:"sh",mdxType:"CodeBlock"},"sudo systemctl disable gyeeta-madhava; sudo yum erase gyeeta-madhava")),(0,l.kt)(s.Z,{value:"suse",label:"SuSE / OpenSuSE",mdxType:"TabItem"},(0,l.kt)(o.Z,{language:"sh",mdxType:"CodeBlock"},"sudo systemctl disable gyeeta-madhava; sudo zypper remove gyeeta-madhava")),(0,l.kt)(s.Z,{value:"fedora",label:"Fedora Linux",mdxType:"TabItem"},(0,l.kt)(o.Z,{language:"sh",mdxType:"CodeBlock"},"sudo systemctl disable gyeeta-madhava; sudo dnf remove gyeeta-madhava"))),(0,l.kt)("h3",{id:"tar-install"},(0,l.kt)("em",{parentName:"h3"},"Manual Tar Package install")),(0,l.kt)("p",null,"If none of the above options can be used to install the Gyeeta Madhava component, a manual tarball extract and configure\ncan be used to install."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Example Install Command"',title:'"Example',Install:!0,'Command"':!0},"\nmkdir ~/gyeeta\ncd ~/gyeeta\ncurl -L https://github.com/gyeeta/gyeeta/releases/download/$( curl https://api.github.com/repos/gyeeta/gyeeta/releases/latest -s | grep tag_name | awk -F\\\" '{print $4}' )/madhava.tar.gz | tar xzf -\ncd ./madhava\n\n# Thereafter create the cfg/madhava_main.json Madhava config file and then start the Madhava server as\n\n./runmadhava.sh start\n\n")),(0,l.kt)("h2",{id:"madhava-failover--redundancy"},"Madhava Failover / Redundancy"),(0,l.kt)("p",null,"Madhava servers can be setup for Multi Node High Availablity by installing 2 or more instances of Madhava\nwhich interact with the same instance of Postgres DB."),(0,l.kt)("p",null,"Please refer to ",(0,l.kt)("a",{parentName:"p",href:"./failover"},"Failover")," for further details."))}c.isMDXComponent=!0}}]);