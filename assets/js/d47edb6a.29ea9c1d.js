"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8394],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>g});var n=a(7294);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var i=n.createContext({}),d=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,s=e.mdxType,r=e.originalType,i=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=d(a),g=s,m=c["".concat(i,".").concat(g)]||c[g]||u[g]||r;return a?n.createElement(m,l(l({ref:t},p),{},{components:a})):n.createElement(m,l({ref:t},p))}));function g(e,t){var a=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=a.length,l=new Array(r);l[0]=c;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o.mdxType="string"==typeof e?e:s,l[1]=o;for(var d=2;d<r;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},4042:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var n=a(7462),s=(a(7294),a(3905));const r={title:"PostgresDB Installation",description:"Gyeeta PostgresDB Installation"},l="Gyeeta PostgresDB Installation",o={unversionedId:"installation/postgresdb_install",id:"installation/postgresdb_install",title:"PostgresDB Installation",description:"Gyeeta PostgresDB Installation",source:"@site/docs/installation/postgresdb_install.md",sourceDirName:"installation",slug:"/installation/postgresdb_install",permalink:"/docs/installation/postgresdb_install",draft:!1,editUrl:"https://github.com/gyeeta.github.io/tree/main/docs/installation/postgresdb_install.md",tags:[],version:"current",lastUpdatedAt:1668108684,formattedLastUpdatedAt:"Nov 10, 2022",frontMatter:{title:"PostgresDB Installation",description:"Gyeeta PostgresDB Installation"},sidebar:"docs",previous:{title:"Install Planning and Options",permalink:"/docs/installation/install_options"},next:{title:"shyama Server Configuration",permalink:"/docs/installation/shyama_config"}},i={},d=[{value:"Shyama Postgres Disk Space Requirement",id:"shyama-dbspace",level:2},{value:"Madhava Postgres Disk Space Requirement",id:"madhava-dbspace",level:2},{value:"CPU and Memory Requirements for PostgresDB",id:"db-cpu-mem",level:2},{value:"Network Connectivity Requirements",id:"network",level:2},{value:"Installation Instructions",id:"installation-instructions",level:2},{value:"<em>Install using Shell script</em>",id:"shell-script",level:3},{value:"<em>Running as a Docker container</em>",id:"docker",level:3},{value:"Run postgresdb DB init first (only once)",id:"run-postgresdb-db-init-first-only-once",level:4},{value:"Run postgresdb after init",id:"run-postgresdb-after-init",level:4},{value:"<em>Install using native rpm or deb packages</em>",id:"rpm-deb",level:3},{value:"Debian/Ubuntu based deb package install",id:"debianubuntu-based-deb-package-install",level:4},{value:"Yum or dnf based rpm Installs",id:"yum-or-dnf-based-rpm-installs",level:4},{value:"OpenSUSE / SUSE Linux based rpm Installs",id:"opensuse--suse-linux-based-rpm-installs",level:4},{value:"PostgresDB Configuration post Installation",id:"postgresdb-configuration-post-installation",level:4},{value:"<em>Manual Tar Package install</em>",id:"tar-install",level:3}],p={toc:d};function u(e){let{components:t,...a}=e;return(0,s.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"gyeeta-postgresdb-installation"},"Gyeeta PostgresDB Installation"),(0,s.kt)("p",null,"Gyeeta Shyama and Madhava servers use PostgresDB as a data store."),(0,s.kt)("p",null,"A single instance of Postgres can support 1 Shyama server and upto 3 Madhava server instances."),(0,s.kt)("admonition",{type:"info"},(0,s.kt)("p",{parentName:"admonition"},"For Kubernetes Helm Charts based installs, Postgres does not need to be installed separately, as the PostgresDB\ncontainer is installed as a sidecar container automatically.")),(0,s.kt)("h2",{id:"shyama-dbspace"},"Shyama Postgres Disk Space Requirement"),(0,s.kt)("p",null,"The PostgresDB instance to be used by Shyama will need about 10 GB of disk space for a typical environment."),(0,s.kt)("h2",{id:"madhava-dbspace"},"Madhava Postgres Disk Space Requirement"),(0,s.kt)("p",null,"Maximum 3 instances of Madhava can share a single PostgresDB instance."),(0,s.kt)("p",null,"The PostgresDB instance to be used by each Madhava will need about 0.5 GB per day of free disk space per monitored host."),(0,s.kt)("p",null,"As an example, lets say there are 200 hosts to be monitored in total and maximum 3 days of statistics history is needed. "),(0,s.kt)("p",null,"This implies that an average of 200 x 0.5 x 3 = 300 GB of free disk space is needed for these 200 hosts."),(0,s.kt)("h2",{id:"db-cpu-mem"},"CPU and Memory Requirements for PostgresDB"),(0,s.kt)("p",null,"Shyama PostgresDB instances will need minimal CPU and Memory requirements :"),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"Max 10% of 1 core CPU and upto 512 MB RAM")),(0,s.kt)("p",null,"Madhava Postgres insatnces need more CPU and Memory requirements :"),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"Max 100% of 1 core CPU and memory ranging from 1 GB to 32 GB RAM depending on the number of hosts the Madhava instance handles")),(0,s.kt)("h2",{id:"network"},"Network Connectivity Requirements"),(0,s.kt)("p",null,"Network connectivity to the PostgresDB instance will need to be provided to the Shyama or Madhava instances using that DB."),(0,s.kt)("h2",{id:"installation-instructions"},"Installation Instructions"),(0,s.kt)("p",null,"Different Install Options exist :"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#shellscript"},"Install using Shell Script")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#docker"},"Running as a Docker container")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#rpm-deb"},"Install using native rpm or deb packages")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"#tar-install"},"Manual Tar Package install"))),(0,s.kt)("p",null,"For Kubernetes, no separate Helm chart needs to be installed as Postgres is automatically installed along with Shyama and Madhava."),(0,s.kt)("h3",{id:"shell-script"},(0,s.kt)("em",{parentName:"h3"},"Install using Shell script")),(0,s.kt)("p",null,"Users can download a shell script that takes care of the installation and configuration of the PostgresDB instance."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o /tmp/install-gyeeta-postgresdb.sh -s https://gyeeta.io/packages/install-gyeeta-postgresdb.sh\n\n# Then run the install script as : \n# sudo bash /tmp/install-gyeeta-postgresdb.sh <Path to DB Data dir> <DB 'postgres' user Password> <Postgres Port to Listen on> <Optional DB Max Memory Shared buffers in MB>\n\n# The DB Data dir will be created if it does not exist. Please ensure that the DB Data dir has adequate Free Disk Space.\n\n# Example Command with gyeetadbPassword as the password :\n\nsudo bash /tmp/install-gyeeta-postgresdb.sh /opt/gyeeta/postgresdb/data gyeetadbPassword 10040\n\n")),(0,s.kt)("p",null,"The install script SHA256 can be checked before installing. The SHA256 of the install script is available at ",(0,s.kt)("a",{parentName:"p",href:"https://gyeeta.io/packages/install-gyeeta-postgresdb.sh.sum"},"SHA256 file")),(0,s.kt)("h3",{id:"docker"},(0,s.kt)("em",{parentName:"h3"},"Running as a Docker container")),(0,s.kt)("p",null,"Running Postgres as a Docker container is a 2 step process. "),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"A one time DB init is needed."),(0,s.kt)("li",{parentName:"ol"},"Therafter, the DB docker container can be run multiple times.")),(0,s.kt)("p",null,"The docker container needs the following inputs :"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"A Volume mount dir for storing the DB data"),(0,s.kt)("li",{parentName:"ul"},"Init DB Password and Port number")),(0,s.kt)("p",null,"The docker container will only run under userid 1001 and groupid 1001. The volume mount dir needs to have its ownership\nchanged to userid:groupid as 1001:1001."),(0,s.kt)("h4",{id:"run-postgresdb-db-init-first-only-once"},"Run postgresdb DB init first (only once)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Example Docker Init Command"',title:'"Example',Docker:!0,Init:!0,'Command"':!0},"\ndocker run -td --rm --name gyeetaInitPostgres --read-only --user 1001:1001 -v /opt/gyeeta/dbdata:/dbdata --env CFG_POSTGRES_PASSWORD=gyeetadbPassword --env CFG_POSTGRES_PORT=10040 ghcr.io/gyeeta/postgresdb --initdb\n\n")),(0,s.kt)("h4",{id:"run-postgresdb-after-init"},"Run postgresdb after init"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Example Docker Command After Init"',title:'"Example',Docker:!0,Command:!0,After:!0,'Init"':!0},"\ndocker run -td --rm --name gyeetaPostgres --read-only --user 1001:1001 -p 10040:10040 -v /opt/gyeeta/dbdata:/dbdata ghcr.io/gyeeta/postgresdb \n\n")),(0,s.kt)("h3",{id:"rpm-deb"},(0,s.kt)("em",{parentName:"h3"},"Install using native rpm or deb packages")),(0,s.kt)("p",null,"Gyeeta native rpm or deb packages are available. The install is to be followed by DB initialization and configuration."),(0,s.kt)("h4",{id:"debianubuntu-based-deb-package-install"},"Debian/Ubuntu based deb package install"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'\ncurl https://pkg.gyeeta.workers.dev/pgp-key.public | sudo gpg --yes --dearmor --output /usr/share/keyrings/gyeeta-keyring.gpg\necho "deb [arch=amd64 signed-by=/usr/share/keyrings/gyeeta-keyring.gpg] https://pkg.gyeeta.workers.dev/apt-repo stable main" | sudo tee /etc/apt/sources.list.d/gyeeta.list\nsudo apt-get update\nsudo apt-get install -y gyeeta-postgresdb\n\n')),(0,s.kt)("h4",{id:"yum-or-dnf-based-rpm-installs"},"Yum or dnf based rpm Installs"),(0,s.kt)("p",null,"For RHEL, Amazon Linux, CentOS, Rocky Linux, Fedora based distributions."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"\nsudo rpm --import https://pkg.gyeeta.workers.dev/pgp-key.public\nsudo curl -s -o /etc/yum.repos.d/gyeeta.repo https://pkg.gyeeta.workers.dev/rpm-repo/gyeeta.repo\n\nif command -v yum > /dev/null; then \n    sudo yum -y update\n    sudo yum install -y gyeeta-postgresdb\nelse\n    sudo dnf -y update\n    sudo dnf install -y gyeeta-postgresdb\nfi  \n\n")),(0,s.kt)("h4",{id:"opensuse--suse-linux-based-rpm-installs"},"OpenSUSE / SUSE Linux based rpm Installs"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"\nsudo rpm --import https://pkg.gyeeta.workers.dev/pgp-key.public\nsudo curl -s -o /etc/zypp/repos.d/gyeeta.repo https://pkg.gyeeta.workers.dev/rpm-repo/gyeeta.repo\nsudo zypper -q -n install gyeeta-postgresdb\n\n")),(0,s.kt)("h4",{id:"postgresdb-configuration-post-installation"},"PostgresDB Configuration post Installation"),(0,s.kt)("p",null,"After the deb or rpm package has been installed, a one time DB initialization is needed. The command to\nrun the init is :"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"sudo -H -u gyeeta $INSTALLDIR/db_install.sh <DB Data directory path> <DB 'postgres' user Password> <Postgres Port to Listen on> <Optional DB Max Shared buffers in MB>")),(0,s.kt)("p",null,"The DB Data dir will be created if it does not exist. Please ensure that the DB Data dir has adequate Free Disk Space."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Example Configure Command"',title:'"Example',Configure:!0,'Command"':!0},"\nsudo -H -u gyeeta /opt/gyeeta/postgresdb/db_install.sh /opt/gyeeta/postgresdb/data gyeetadbPassword 10040\n\n# Thereafter start the gyeeta-postgresdb \nsudo systemctl start gyeeta-postgresdb\nsudo systemctl enable gyeeta-postgresdb\n\n")),(0,s.kt)("h3",{id:"tar-install"},(0,s.kt)("em",{parentName:"h3"},"Manual Tar Package install")),(0,s.kt)("p",null,"If none of the above options can be used to install the Gyeeta PostgresDB component, a manual tarball extract and configure\ncan be used to install."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Example Install Command"',title:'"Example',Install:!0,'Command"':!0},"\nmkdir ~/gyeeta\ncd ~/gyeeta\ncurl -L https://github.com/Gyeeta/postgresdb/releases/download/v0.1.0/postgresdb.tar.gz | tar xzf -\ncd ./postgresdb\n\n# Thereafter configure the DB\n# ./db_install.sh <DB Data directory> <DB 'postgres' user password> <Postgres Port to Listen on> <Optional DB Max Shared buffers in MB>\n\n./db_install.sh ./data dbPassword 10040\n\n# Then start the DB\n./rundb.sh start\n\n")))}u.isMDXComponent=!0}}]);