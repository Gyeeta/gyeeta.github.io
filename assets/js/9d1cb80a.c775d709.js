"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4119],{3905:(e,a,t)=>{t.d(a,{Zo:()=>p,kt:()=>c});var n=t(7294);function i(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function s(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function r(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?s(Object(t),!0).forEach((function(a){i(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,i=function(e,a){if(null==e)return{};var t,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],a.indexOf(t)>=0||(i[t]=e[t]);return i}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=n.createContext({}),d=function(e){var a=n.useContext(l),t=a;return e&&(t="function"==typeof e?e(a):r(r({},a),e)),t},p=function(e){var a=d(e.components);return n.createElement(l.Provider,{value:a},e.children)},h={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},m=n.forwardRef((function(e,a){var t=e.components,i=e.mdxType,s=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=d(t),c=i,u=m["".concat(l,".").concat(c)]||m[c]||h[c]||s;return t?n.createElement(u,r(r({ref:a},p),{},{components:t})):n.createElement(u,r({ref:a},p))}));function c(e,a){var t=arguments,i=a&&a.mdxType;if("string"==typeof e||i){var s=t.length,r=new Array(s);r[0]=m;var o={};for(var l in a)hasOwnProperty.call(a,l)&&(o[l]=a[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,r[1]=o;for(var d=2;d<s;d++)r[d]=t[d];return n.createElement.apply(null,r)}return n.createElement.apply(null,t)}m.displayName="MDXCreateElement"},1197:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var n=t(7462),i=(t(7294),t(3905));const s={title:"madhava Server Configuration",description:"madhava Intermediate Server Configuration",keywords:["madhava","configuration"]},r="Madhava Intermediate Server Configuration",o={unversionedId:"installation/madhava_config",id:"installation/madhava_config",title:"madhava Server Configuration",description:"madhava Intermediate Server Configuration",source:"@site/docs/installation/madhava_config.md",sourceDirName:"installation",slug:"/installation/madhava_config",permalink:"/docs/installation/madhava_config",draft:!1,editUrl:"https://github.com/gyeeta.github.io/tree/main/docs/installation/madhava_config.md",tags:[],version:"current",lastUpdatedAt:1668440029,formattedLastUpdatedAt:"Nov 14, 2022",frontMatter:{title:"madhava Server Configuration",description:"madhava Intermediate Server Configuration",keywords:["madhava","configuration"]},sidebar:"docs",previous:{title:"shyama Server Installation",permalink:"/docs/installation/shyama_install"},next:{title:"madhava Server Installation",permalink:"/docs/installation/madhava_install"}},l={},d=[{value:"Listen Port",id:"listener-port",level:2},{value:"Madhava Name",id:"madhava-name",level:2},{value:"Shyama Hosts",id:"shyama-hosts",level:2},{value:"Shyama Ports",id:"shyama-ports",level:2},{value:"Shyama Secret",id:"shyama-secret",level:2},{value:"Service Hostname",id:"service-hostname",level:2},{value:"Service Port",id:"service-port",level:2},{value:"Postgres Hostname",id:"postgres-hostname",level:2},{value:"Postgres Port",id:"postgres-port",level:2},{value:"Postgres User",id:"postgres-user",level:2},{value:"Postgres Password",id:"postgres-password",level:2},{value:"Postgres Storage History # Days",id:"postgres-storage-days",level:2},{value:"Cloud Operator Type",id:"cloud-type",level:2},{value:"Network Region Name",id:"region-name",level:2},{value:"Network Zone Name",id:"zone-name",level:2},{value:"Sample JSON Config file",id:"sample-json",level:2}],p={toc:d};function h(e){let{components:a,...t}=e;return(0,i.kt)("wrapper",(0,n.Z)({},p,t,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"madhava-intermediate-server-configuration"},"Madhava Intermediate Server Configuration"),(0,i.kt)("p",null,"Madhava is Gyeeta's Intermediate server. One or more Madhava instances serve as the Intermediate servers to which all\nthe monitored Hosts Partha instances will communicate with."),(0,i.kt)("p",null,"Madhava Servers will also connect to Shyama server and other Madhava instances in a mesh style network. "),(0,i.kt)("p",null,"Madhava server reads its configuration from a ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/JSON"},"JSON")," file or as environment variables.\nEnvironment variables will take precedence over the config file in case of a conflict."),(0,i.kt)("p",null,"A sample Madhava JSON config file is given ",(0,i.kt)("a",{parentName:"p",href:"#sample-json"},"below"),"."),(0,i.kt)("p",null,"The list of Config options include :"),(0,i.kt)("h2",{id:"listener-port"},"Listen Port"),(0,i.kt)("p",null,"By default, Madhava will listen on TCP port 10038. The JSON field for the Listen Port\nis named ",(0,i.kt)("inlineCode",{parentName:"p"},"listener_port"),". The corresponding environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_LISTENER_PORT"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("h2",{id:"madhava-name"},"Madhava Name"),(0,i.kt)("p",null,"Each Madhava server is associated with its unique name. This name is also the DB name\nto be used in PostgresDB."),(0,i.kt)("p",null,"The JSON field name is ",(0,i.kt)("inlineCode",{parentName:"p"},"madhava_name")," and corresponding environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_MADHAVA_NAME"),"."),(0,i.kt)("p",null,"This field is mandatory and max madhava name length is 64 bytes. "),(0,i.kt)("h2",{id:"shyama-hosts"},"Shyama Hosts"),(0,i.kt)("p",null,"This config param indicates the list of hostnames of the Shyama instances. The format\nof this param is a JSON array of one or more Shyama hostnames or IP addresses. "),(0,i.kt)("p",null,"This param is to be used along with ",(0,i.kt)("a",{parentName:"p",href:"#shyama-ports"},"Shyama Ports")," to indicate the Shyama servers."),(0,i.kt)("p",null,"If multiple Shyama instances are running due to High Availability, the number of elements in the\nJSON array will be more than 1. Under such cases, the Madhava instance will try connecting to only\nthe Active Shyama instance (Other instances being the Passive instances)."),(0,i.kt)("p",null,"The JSON field name is ",(0,i.kt)("inlineCode",{parentName:"p"},"shyama_hosts")," and corresponding environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_SHYAMA_HOSTS"),"."),(0,i.kt)("p",null,"This field is mandatory. "),(0,i.kt)("p",null,"The Hostnames or IP Addresses mentioned in this option must be same as the\n",(0,i.kt)("a",{parentName:"p",href:"./shyama_config#service-hostname"},"Shyama Server Service Hostname"),"."),(0,i.kt)("p",null,"Example usages : "),(0,i.kt)("p",null,'[ "shyamahost1.local" ]'," : Here a single instance of Shyama is specified."),(0,i.kt)("p",null,'[ "shyama1.local", "192.168.0.2" ]'," : Here 2 instances of Shyama are running in Active Passive mode."),(0,i.kt)("h2",{id:"shyama-ports"},"Shyama Ports"),(0,i.kt)("p",null,"This config param indicates the list of TCP ports of the Shyama instances. The format\nof this param is a JSON array of one or more Shyama TCP ports."),(0,i.kt)("p",null,"This param is to be used along with ",(0,i.kt)("a",{parentName:"p",href:"#shyama-hosts"},"Shyama Hosts")," to indicate the Shyama servers.\nThe number of elements in this JSON array must match the number of elements specified in\n",(0,i.kt)("a",{parentName:"p",href:"#shyama-hosts"},"Shyama Hosts"),". "),(0,i.kt)("p",null,"The JSON field name is ",(0,i.kt)("inlineCode",{parentName:"p"},"shyama_ports")," and corresponding environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_SHYAMA_PORTS"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("p",null,"The TCP Ports mentioned in this option must be same as the\n",(0,i.kt)("a",{parentName:"p",href:"./shyama_config#service-port"},"Shyama Server Service Port"),"."),(0,i.kt)("p",null,"Example usages : "),(0,i.kt)("p",null,"[ 10037 ]"," : Here a single instance of Shyama is specified."),(0,i.kt)("p",null,"[ 10037, 10037 ]"," : Here 2 instances of Shyama are running in Active Passive mode."),(0,i.kt)("h2",{id:"shyama-secret"},"Shyama Secret"),(0,i.kt)("p",null,"This is the configured ",(0,i.kt)("a",{parentName:"p",href:"./shyama_config#shyama-secret"},"Shyama secret")," phrase to be used to authenticate\nconnecting Madhava instances."),(0,i.kt)("p",null,"The JSON field name is ",(0,i.kt)("inlineCode",{parentName:"p"},"shyama_secret")," and corresponding environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_SHYAMA_SECRET"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("h2",{id:"service-hostname"},"Service Hostname"),(0,i.kt)("p",null,"This indicates the Domain Name or IP Address that other components such as Partha Host Agents, Node Webserver\nand other Madhava instances will use to connect to this Shyama instance."),(0,i.kt)("p",null,"In most instances this would be the Hostname of the Madhava server. But in cases where Virtual IP/Hostname/ NAT Translation is\napplicable such as Kubernetes, this would be the Virtual IP or Service Hostname."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"The Madhava instance must be accessible to the Partha Host Monitor Agents and the Node Webserver through this\nService Hostname / IP. In case multiple Network Regions are active and multiple Madhava instances are assigned\nsay one per Network Zone/Region, it is preferable though not mandatory that\n",(0,i.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html"},"VPC Network Peering")," or some other\nsuch mechanism be active so that Madhava instances in other regions can connect to this Madhava instance in a\nmesh network topology.")),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"service_hostname")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_SERVICE_HOSTNAME"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("h2",{id:"service-port"},"Service Port"),(0,i.kt)("p",null,"This indicates the TCP Port that other components will use to connect to this Shyama instance."),(0,i.kt)("p",null,"In most instances this would be the Listener Port of the Shyama server. But in cases where Virtual Port or NAT Translation is\napplicable such as Kubernetes, this would be the Service Port."),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"service_port")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_SERVICE_PORT"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("h2",{id:"postgres-hostname"},"Postgres Hostname"),(0,i.kt)("p",null,"This indicates the Domain or IP address of the Postgres DB to be used by this Madhava instance."),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"postgres_hostname")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_POSTGRES_HOSTNAME"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("h2",{id:"postgres-port"},"Postgres Port"),(0,i.kt)("p",null,"This indicates the TCP port of the Postgres DB to be used by this Madhava instance."),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"postgres_port")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_POSTGRES_PORT"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("h2",{id:"postgres-user"},"Postgres User"),(0,i.kt)("p",null,"This indicates the Postgres Username to be used by this Madhava instance."),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"postgres_user")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_POSTGRES_USER"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("h2",{id:"postgres-password"},"Postgres Password"),(0,i.kt)("p",null,"This indicates the Postgres User Password to be used by this Madhava instance."),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"postgres_password")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_POSTGRES_PASSWORD"),"."),(0,i.kt)("p",null,"This field is mandatory."),(0,i.kt)("h2",{id:"postgres-storage-days"},"Postgres Storage History # Days"),(0,i.kt)("p",null,"This indicates the number of days of DB Hostory to be kept."),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"postgres_storage_days")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_POSTGRES_STORAGE_DAYS"),"."),(0,i.kt)("p",null,"This field is optional and default is 3 days."),(0,i.kt)("h2",{id:"cloud-type"},"Cloud Operator Type"),(0,i.kt)("p",null,"This field indicates the Cloud Operator this Madhava instance is running on. This is needed\nto get the Network Region and Zone."),(0,i.kt)("p",null,"Currently supported Cloud Operator Metadata collection are : aws, gcp and azure. "),(0,i.kt)("p",null,"For other Cloud Operators or in case of own data centers, this field should be ignored."),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"cloud_type")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_CLOUD_TYPE"),"."),(0,i.kt)("p",null,"This field is optional."),(0,i.kt)("h2",{id:"region-name"},"Network Region Name"),(0,i.kt)("p",null,"This field must be used only if the preceding ",(0,i.kt)("a",{parentName:"p",href:"#cloud-type"},"Cloud Operator type")," is empty. This field\nindicates the Network Region Name this Madhava host is operating under. "),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"region_name")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_REGION_NAME"),"."),(0,i.kt)("p",null,"This field is optional."),(0,i.kt)("h2",{id:"zone-name"},"Network Zone Name"),(0,i.kt)("p",null,"This field must be used only if the preceding ",(0,i.kt)("a",{parentName:"p",href:"#cloud-type"},"Cloud Operator type")," is empty. This field\nindicates the Network Zone Name this Madhava host is operating under. "),(0,i.kt)("p",null,"The JSON field is ",(0,i.kt)("inlineCode",{parentName:"p"},"zone_name")," and environment variable is ",(0,i.kt)("inlineCode",{parentName:"p"},"CFG_ZONE_NAME"),"."),(0,i.kt)("p",null,"This field is optional."),(0,i.kt)("h2",{id:"sample-json"},"Sample JSON Config file"),(0,i.kt)("p",null,"A sample Madhava JSON config file is provided below :"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n        "listener_ip"           :   "0.0.0.0",\n        "listener_port"         :   10038,\n        "madhava_name"          :   "madhava_useast1",\n        "service_hostname"      :   "madhava-useast1.local",\n        "service_port"          :   10038,\n        "cloud_type"            :   "aws",\n\n        "shyama_hosts"          :   [ "shyama1.local" ],\n        "shyama_ports"          :   [ 10037 ],\n        "shyama_secret"         :   "This is a secret",\n        \n        "postgres_hostname"     :   "db1.local",\n        "postgres_port"         :   10040,\n        "postgres_user"         :   "postgres",\n        "postgres_password"     :   "dbPassword",\n        "postgres_storage_days" :   3\n}\n    \n\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Explanation of above sample config")),(0,i.kt)("p",null,"In the above sample config, the madhava server will listen on port 10038, with other Gyeeta componenets such\nas Partha Host Agents and other Madhava servers connecting to this Madhava instance at madhava-useast1.local:10038."),(0,i.kt)("p",null,"The Madhava instance will connect to Shyama server at shyama1.local:10037. "),(0,i.kt)("p",null,"The Madhava instance will connect to remote Postgres DB db1.local:10040 as ",(0,i.kt)("inlineCode",{parentName:"p"},"postgres")," user with password\nas dbPassword and with max history of 3 days."))}h.isMDXComponent=!0}}]);