<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-querying/aggregation">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Query Aggregation | Gyeeta</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://gyeeta.io/docs/querying/aggregation"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Query Aggregation | Gyeeta"><meta data-rh="true" name="description" content="Query Aggregation"><meta data-rh="true" property="og:description" content="Query Aggregation"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://gyeeta.io/docs/querying/aggregation"><link data-rh="true" rel="alternate" href="https://gyeeta.io/docs/querying/aggregation" hreflang="en"><link data-rh="true" rel="alternate" href="https://gyeeta.io/docs/querying/aggregation" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Gyeeta Observability Blog RSS Feed"><link rel="stylesheet" href="/assets/css/styles.ac36b788.css">
<link rel="preload" href="/assets/js/runtime~main.fc81c02e.js" as="script">
<link rel="preload" href="/assets/js/main.cb539e6f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/gyeeta.png" alt="Gyeeta Logo" class="themedImage_ToTc themedImage--light_HNdA" style="border-radius:50%"><img src="/img/gyeeta.png" alt="Gyeeta Logo" class="themedImage_ToTc themedImage--dark_i4oU" style="border-radius:50%"></div><b class="navbar__title text--truncate">Gyeeta</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/livedemo">Live Demo</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gyeeta/gyeeta" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/installation--configuration">Installation &amp; Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation &amp; Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/monitor/overview">Monitoring Features &amp; Limitations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/monitor/termsused">Technical Terms used</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/query-analysis">Query Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Query Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/querying/queryoverview">Networking &amp; Subsystems</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/querying/datatypes">Query Data Types &amp; Filters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/querying/aggregation">Query Aggregation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/querying/stateclassify">State Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/querying/groupprocess">Grouped Processes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/querying/netflows">Network Flows / Service Maps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/querying/k8s">Kubernetes Analysis</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/web-ui">Web UI</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web UI&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/searchshow">Search Showcase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/livedemo">Live Demo</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/alerts-guide">Alerts Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Alerts Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/developer-apis">Developer APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/query-analysis"><span itemprop="name">Query Analysis</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Query Aggregation</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Query Aggregation</h1><p>Aggregation refers to operations on a set of individual records to form a reduced (aggregated) resultset. In Gyeeta,
Aggregation operates on a time duration of 1 min or more. Aggregation intervals define the step size used for aggregation operations on the resultset.</p><p>Aggregation always starts with the resultset of a single host. For a multi host query (query spanning multiple hosts), aggregation will be done
per host as a first step followed by a later second pass aggregation. </p><p>Within a single host, the aggregation will first retrieve the detailed resultset matching any filters (pre-aggregated filters) set. Thereafter,
the aggregation will apply the Aggregation Operators on each field. </p><p>The Search Web UI Video shown below shows examples of Query Aggregation (both Predefined and Custom).</p><iframe width="500px" height="300px" src="https://www.youtube.com/embed/_6nGLY2YcIo?rel=0" title="Gyeeta YouTube video player" frameborder="0" hd="1" allow="fullscreen; accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><h2 class="anchor anchorWithStickyNavbar_LWe7" id="aggregation-operators">Aggregation Operators<a class="hash-link" href="#aggregation-operators" title="Direct link to heading">​</a></h2><p>Aggregation Operators supported in Gyeeta are :</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="string-field-aggregation-operators">String Field Aggregation Operators<a class="hash-link" href="#string-field-aggregation-operators" title="Direct link to heading">​</a></h3><ul><li>Group By (implicitly used for all string fields unless other operators specified)</li><li>First Element (<code>first_elem</code>)</li><li>Last Element (<code>last_elem</code>)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="numeric-field-aggregation-operators">Numeric Field Aggregation Operators<a class="hash-link" href="#numeric-field-aggregation-operators" title="Direct link to heading">​</a></h3><ul><li>Average (mean) (<code>avg</code>)</li><li>Sum of the fields (<code>sum</code>)</li><li>Maximum (<code>max</code>)</li><li>Minimum (<code>min</code>)</li><li>Percentile (for e.g. p99) (<code>percentile</code>)</li><li>First Element (<code>first_elem</code>)</li><li>Last Element (<code>last_elem</code>)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="boolean-field-aggregation-operators">Boolean Field Aggregation Operators<a class="hash-link" href="#boolean-field-aggregation-operators" title="Direct link to heading">​</a></h3><ul><li>Boolean OR (<code>bool_or</code>)</li><li>Boolean AND (<code>bool_and</code>)</li><li>Count of condition (<code>count</code>)</li></ul><p>After applying the desired Aggregation Operator on each field, the resultset will get reduced. For Single Host queries, the query is deemed complete
at this point.</p><p>For multi host queries, a second pass aggregation will next take place, which will aggregate across the first pass single host aggregated resultset.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="aggregation-interval">Aggregation Interval<a class="hash-link" href="#aggregation-interval" title="Direct link to heading">​</a></h2><p>Aggregation Intervals define the step size for Aggregations within a single Host. For example, if a query is for aggregating Service States for last
3 hours with an aggregation interval of 5 minutes, it implies multiple aggregations one after the other will be done on each 5 minute dataset.</p><p>If users want a single aggregated resultset the Aggregation Interval must be set to at least the entire query time duration. For example, in the
above case, the Aggregation Interval must be at least 3 hours.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pre-aggregation--post-aggregation-filters">Pre-Aggregation / Post-Aggregation Filters<a class="hash-link" href="#pre-aggregation--post-aggregation-filters" title="Direct link to heading">​</a></h2><p>Pre-Aggregation Filters are the first level filters that can be used to reduce the dataset needed for the aggregation. In other words,
Pre-Aggregation Filters are applied to the dataset <em>before</em> any aggregation is done.</p><p>For example, lets say you need to query Process State aggregation for a specific cluster. In this case the cluster name should be
specified in the pre-aggregation filters. If the cluster name filter were instead specified in the post-aggregation filter, it would have
resulted in an inefficient query, as the dataset for all clusters would have been scanned in the first pass.</p><p>Post-Aggregation filters are applied <em>after</em> the aggregation has been executed to further reduce the resultset. </p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Post Aggregation filters are <strong>mandatory</strong> for DB Aggregation Alerts.</p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Gyeeta REST API querying by default, will assume non-aggregated (or detailed) resultsets. To specify aggregation in REST APIs, users need to
specify <code>aggregate</code> as true within the &quot;options&quot; JSON object of the request. </p><p>An example cURL command showing the extsvcstate REST API call with both pre-aggregation and post-aggregation filters set
(pre-aggregation filter within &quot;filter&quot; and post-aggregation within &quot;aggrfilter&quot; fields) :</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;http://dev204.local:10039/v1/extsvcState&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  -H </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJyb2xlIjpbImFkbWluIl0sImlhdCI6MTY1NjI2MTgwNywiZXhwIjoxNjU2MzQ4MjA3fQ.tma_H727ek7RGDmKHPvL3lEI5CBVgETNYDwMREnsC4E&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  -H </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Content-Type: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  -d </span><span class="token string" style="color:rgb(255, 121, 198)">$&#x27;{&quot;starttime&quot;:&quot;2022-06-26T19:02:05+05:30&quot;,&quot;endtime&quot;:&quot;2022-06-26T20:02:05+05:30&quot;,&quot;timeoutsec&quot;:500, &quot;options&quot;:{&quot;maxrecs&quot;:10000,&quot;aggregate&quot;:true,&quot;aggrsec&quot;:300,&quot;aggroper&quot;:&quot;avg&quot;,&quot;filter&quot;:&quot; { cluster substr \&#x27;k8s\&#x27; } &quot;,&quot;aggrfilter&quot;:&quot; { nconns &gt; 10 } &quot;}}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="predefined-subsystem-aggregations">Predefined Subsystem Aggregations<a class="hash-link" href="#predefined-subsystem-aggregations" title="Direct link to heading">​</a></h2><p>Gyeeta provides Predefined Aggregation Queries for all subsystems which support aggregation for quick querying without knowing all the fields available.</p><p>The Predefined Aggregation Queries result in an aggregation which contains most of the fields available in the Detailed (non-aggregated) resultsets. </p><p>These aggregations do not give the users many options to change the field aggregations. The only options supported are :</p><ul><li>Choice of Default Numerical Aggregation Operation (default is <code>avg</code>)</li><li>Aggregation Interval </li></ul><p>Another side-effect of using the Predefined Subsystem Aggregations is that the fields in most subsystem predefined aggregates will also include Host unique
fields such as <code>parid</code> (Partha ID) and <code>host</code> (Hostname). The resultant aggregations will therefore not be aggregated across hosts but only within a host.</p><p>Also, Predefined Aggregations for subsystems such as Service State, Process State will include not just Host unique fields mentioned above, but also
globally unique fields such as <code>svcid</code> (Service ID) and <code>procid</code> (Grouped Process ID (not PID)). This will result in aggregations which are both
Host unique and Service or Process unique within the host as well. </p><p>For example, lets say a Host has 2 separate instances of <code>redis</code> running resulting in 2 different <code>svcid</code>. The <code>extsvcstate</code> and <code>svcstate</code> subsystem
Predefined aggregations will then not combine statistics of these 2 instances for aggregations but will consider them as different instances which is
what is needed in most cases. But if users want to combine statistics of all <code>redis</code> instances across all hosts and aggregate them, they will need
to use the Custom Aggregation Query.</p><p>Using the Predefined Aggregations gives users a quick way to get aggregated statistics. But if the users need more fine-tuned stats, they will need to define
a Custom Aggregation Query as explained below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="custom-aggregation">Custom Aggregation Queries<a class="hash-link" href="#custom-aggregation" title="Direct link to heading">​</a></h2><p>Custom Aggregation Queries gives the user the option to select specific fields from within the detailed (non aggregated) resultset to use for aggregations
and allows users custom aggregation operations which are not provided in the Predefined Aggregations.</p><p>To aggregate statistics across hosts as a consolidated single row, Custom Aggregation is needed wherein the columns selected should not be Host specific.</p><p>For example, the following is a Custom Aggregation REST API example for svcstate subsystem with custom aggregation operations specified within the <em>columns</em> field :</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> http://localhost:10039/v1/svcstate </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -H </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJyb2xlIjpbImFkbWluIl0sImlhdCI6MTY1NjI2NjkwNCwiZXhwIjoxNjU2MzUzMzA0fQ.YQvdxawLsq_j6TcG5aeTVQffV84v8GRM3GJkoWamjHs&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -H </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Content-Type: application/json&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -d </span><span class="token string" style="color:rgb(255, 121, 198)">$&#x27;{&quot;timeoffsetsec&quot; : 3600, &quot;timeout&quot; : 300,  &quot;options&quot; : { &quot;aggregate&quot; : true, &quot;aggroper&quot; : &quot;max&quot;, &quot;columns&quot; : [ &quot;name&quot;,  &quot;ishttp&quot;, &quot;max(iodelus)/1000 as maxiodelms&quot;, &quot;avg(resp5s)/max(resp5s) * 100 as respratio&quot;, &quot;sum(sererr + clierr)/sum(nqry5s)  * 100 as weberrpct&quot;, &quot;avg(kbin15s + kbout15s)/1024 as avgnwmb&quot;, &quot;last_elem(resp5s) as lastresp&quot;, &quot;percentile(99, resp5s) as pctresp5s&quot;, &quot;count(sererr + clierr &gt; 0) as weberrs&quot; ], &quot;aggrfilter&quot; : &quot;( { maxiodelms &gt; 0 } and { avgnwmb &gt;= 1000 } )&quot; , &quot;filter&quot; : &quot;( { name in \&#x27;postgres\&#x27;, \&#x27;node\&#x27;, \&#x27;server\&#x27; } )&quot; } }&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The columns (fields) specified for the Custom Aggregation can also refer to the Predefined Aggregation fields (as seen from above where <code>name</code> and <code>ishttp</code>
are from Predefined fields).</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The above Custom Query can also be executed from the Web UI Search Page which provides a simpler interface to quickly create Custom Aggregation columns.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-aggregation-consolidation-across-madhava-instances">Custom Aggregation Consolidation across madhava instances<a class="hash-link" href="#custom-aggregation-consolidation-across-madhava-instances" title="Direct link to heading">​</a></h3><p>Currently, consolidated Custom Aggregation will aggregate records seen within hosts of a single <code>madhava</code> Intermediate Server and not across all
<code>madhava</code> instances. In other words, each <code>madhava</code> instance will have its unique consolidated row instead of a single consolidated row
globally and there will be multiple rows within the final resultset, one for each <code>madhava</code>.</p><p>A single <code>madhava</code> can handle hundreds of hosts. So the Custom Aggregation will still span hundreds of hosts within a single row.</p><p>This limitation will be removed in a future release.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/gyeeta/gyeeta.github.io/tree/main/docs/querying/aggregation.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-07-05T10:28:19.000Z">Jul 5, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/querying/datatypes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Query Data Types &amp; Filters</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/querying/stateclassify"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">State Classification</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#aggregation-operators" class="table-of-contents__link toc-highlight">Aggregation Operators</a><ul><li><a href="#string-field-aggregation-operators" class="table-of-contents__link toc-highlight">String Field Aggregation Operators</a></li><li><a href="#numeric-field-aggregation-operators" class="table-of-contents__link toc-highlight">Numeric Field Aggregation Operators</a></li><li><a href="#boolean-field-aggregation-operators" class="table-of-contents__link toc-highlight">Boolean Field Aggregation Operators</a></li></ul></li><li><a href="#aggregation-interval" class="table-of-contents__link toc-highlight">Aggregation Interval</a></li><li><a href="#pre-aggregation--post-aggregation-filters" class="table-of-contents__link toc-highlight">Pre-Aggregation / Post-Aggregation Filters</a></li><li><a href="#predefined-subsystem-aggregations" class="table-of-contents__link toc-highlight">Predefined Subsystem Aggregations</a></li><li><a href="#custom-aggregation" class="table-of-contents__link toc-highlight">Custom Aggregation Queries</a><ul><li><a href="#custom-aggregation-consolidation-across-madhava-instances" class="table-of-contents__link toc-highlight">Custom Aggregation Consolidation across madhava instances</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/gyeeta/gyeeta/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/gyeeta" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/GyeetaIO" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/gyeeta/gyeeta" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://youtube.com/@gyeeta" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/gyeeta.png" alt="Gyeeta Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="96" height="96"><img src="/img/gyeeta.png" alt="Gyeeta Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="96" height="96"></div><div class="footer__copyright">Copyright © 2023 Exact Solutions, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fc81c02e.js"></script>
<script src="/assets/js/main.cb539e6f.js"></script>
</body>
</html>